<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<title>Santa Puzzle Quest ğŸ…âœ¨</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0" />

<style>
    body {
        margin: 0;
        font-family: system-ui, -apple-system, BlinkMacSystemFont, sans-serif;
        background: #0a0d2c;
        color: #fff;
        text-align: center;
    }
    .screen {
        display: none;
        padding: 20px;
    }
    .active { display: block; }

    button {
        background: #ffcf4d;
        color: #4a2c00;
        padding: 10px 20px;
        border-radius: 14px;
        border: none;
        font-weight: bold;
        cursor: pointer;
        margin-top: 20px;
        font-size: 1rem;
    }
    input {
        width: 80%;
        max-width: 300px;
        padding: 10px;
        margin: 6px 0;
        border-radius: 10px;
        border: none;
        font-size: 1rem;
    }

    .clue-box {
        background: #14204d;
        padding: 18px;
        border-radius: 14px;
        margin: 20px auto;
        width: 90%;
        max-width: 380px;
        font-size: 1.1rem;
        line-height: 1.5rem;
    }

    #buddy {
        font-size: 3rem;
        margin-bottom: 10px;
    }

    #message {
        margin-top: 10px;
        font-size: 1rem;
        min-height: 2rem;
    }
</style>
</head>

<body>

<!-- â­ SCENE 0 â€” Intro -->
<div id="scene0" class="screen active">
    <h1>ğŸ… Santa Is Missing!!</h1>

    <p style="font-size:1.1rem; line-height:1.5rem;">
        Oh no! Santa went to check on his reindeer, slipped on a candy cane,  
        and *POOF!* â€” vanished into Christmas air! ğŸ˜±  
        The elves searched high and low, but stillâ€¦ **NO SANTA!**  
        We need YOU, the brave Christmas Detective,  
        to solve clues and bring Santa home! ğŸ„ğŸ•µï¸â€â™‚ï¸
    </p>

    <button onclick="goToSetup()">Begin the Quest</button>
</div>

<!-- â­ SETUP SCREEN -->
<div id="setup" class="screen">
    <h2>ğŸ„ Grown-ups: Enter 4 Places</h2>
    <p>Examples: Kitchen, Backyard, Living Room, Grandmaâ€™s House</p>

    <input id="city" placeholder="City or Town (optional)" /><br>
    <input id="loc1" placeholder="Location 1" /><br>
    <input id="loc2" placeholder="Location 2" /><br>
    <input id="loc3" placeholder="Location 3" /><br>
    <input id="loc4" placeholder="Location 4" /><br>

    <button onclick="startGame()">Start Puzzle Adventure</button>
</div>

<!-- â­ GAME SCENE -->
<div id="game" class="screen">
    <div id="buddy">ğŸ§â€â™‚ï¸</div>
    <h2 id="sceneTitle"></h2>

    <div class="clue-box" id="clueText"></div>

    <input id="answerBox" placeholder="Type your answerâ€¦" />
    <button onclick="submitAnswer()">Submit</button>

    <div id="message"></div>

    <button id="nextBtn" style="display:none;" onclick="nextScene()">Next Scene</button>
</div>

<!-- â­ FINAL SCENE -->
<div id="final" class="screen">
    <h1>ğŸ…âœ¨ You Found Santa!</h1>

    <p style="font-size:1.1rem; line-height:1.5rem;">
        Santa saw your clever clues and jumped with joy!  
        He and Buddy are now heading back to the North Pole â€”  
        and they want to say **THANK YOU** for saving Christmas! ğŸ„â¤ï¸  
    </p>

    <p style="font-size:3rem;">ğŸ‘‹ğŸ…</p>

    <button onclick="restart()">Play Again</button>
</div>

<script>
/* -------------------
   STATE MANAGEMENT
-------------------- */
let currentScene = 1;
let locations = [];
let cityName = "";
let correctAnswers = [];
let hintTimer = null;

/* -------------------
   RHYMING CLUE BUILDER
-------------------- */
function buildClue(location) {
    return (
        `Buddy found a clue, oh what a sight!<br>` +
        `It softly glows in the Christmas night.<br><br>` +
        `It reads:<br>` +
        `â€œIâ€™m hiding near the **${location}**, you seeâ€¦<br>` +
        `Guess the place and come find me!â€`
    );
}

/* -------------------
   DEFAULT LOCATIONS
-------------------- */
function fillDefaultLocations() {
    return [
        "Kitchen",
        "Backyard",
        "Living Room",
        "Front Porch"
    ];
}

/* -------------------
   SCENE SWITCHING
-------------------- */
function show(screenId) {
    document.querySelectorAll(".screen").forEach(s => s.classList.remove("active"));
    document.getElementById(screenId).classList.add("active");
}

function goToSetup() { show("setup"); }

/* -------------------
   START GAME
-------------------- */
function startGame() {
    cityName = document.getElementById("city").value.trim();

    const l1 = document.getElementById("loc1").value.trim();
    const l2 = document.getElementById("loc2").value.trim();
    const l3 = document.getElementById("loc3").value.trim();
    const l4 = document.getElementById("loc4").value.trim();

    locations = [l1, l2, l3, l4];

    // fill blanks with defaults
    const defaults = fillDefaultLocations();
    for (let i = 0; i < 4; i++) {
        if (!locations[i]) locations[i] = defaults[i];
    }

    correctAnswers = locations.map(l => l.toLowerCase());

    currentScene = 1;
    loadScene();
    show("game");
}

/* -------------------
   LOAD A SCENE
-------------------- */
function loadScene() {
    if (currentScene > 4) {
        show("final");
        return;
    }

    const loc = locations[currentScene - 1];

    document.getElementById("sceneTitle").innerHTML =
        `Scene ${currentScene} â€” Searching in ${cityName || "your town"}!`;

    document.getElementById("clueText").innerHTML = buildClue(loc);

    document.getElementById("message").innerHTML = "";
    document.getElementById("answerBox").value = "";
    document.getElementById("nextBtn").style.display = "none";

    startHintTimer(loc);
}

/* -------------------
   HINT TIMER (5 minutes)
-------------------- */
function startHintTimer(location) {
    if (hintTimer) clearTimeout(hintTimer);

    hintTimer = setTimeout(() => {
        document.getElementById("message").innerHTML =
            `ğŸ§â€â™‚ï¸ Buddy Hint: â€œThink carefullyâ€¦ where might Santa rest?<br>` +
            `Try looking near the <b>${location}</b>!â€`;
    }, 5 * 60 * 1000); // 5 minutes
}

/* -------------------
   SUBMIT ANSWER
-------------------- */
function submitAnswer() {
    const user = document.getElementById("answerBox").value.trim().toLowerCase();
    const correct = correctAnswers[currentScene - 1];

    if (user === correct) {
        document.getElementById("message").innerHTML =
            `ğŸ‰ Correct! Santa WAS hiding near the <b>${locations[currentScene - 1]}</b>!`;
        document.getElementById("nextBtn").style.display = "inline-block";
        clearTimeout(hintTimer);
    } else {
        document.getElementById("message").innerHTML =
            `âŒ Not quite! Try again, detective!`;
    }
}

/* -------------------
   NEXT SCENE
-------------------- */
function nextScene() {
    currentScene++;
    loadScene();
}

/* -------------------
   RESTART
-------------------- */
function restart() {
    show("scene0");
}
</script>

</body>
</html>
